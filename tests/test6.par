type CoList<a> = iterative choice {
	.end => !,
	.item => (a) self,
}

dec FinFilter : [type a] [CoList<box a>, box [box a] Bool, Nat] CoList<box a>
def FinFilter =
	[type a]
	[xs, f, n]
	begin case {
		.end => xs.end,
		.item =>
			do { xs.item[x] } in
			Nat.RepeatLazy(n).begin@search.case {
				.end! => (x) loop,
				.step i => f(x).case {
					.false! =>
						do { xs.item[x] } in
						i.next.loop@search,
					.true! => (x) loop,
				},
			},
	}

dec Take : [type a] [CoList<a>, Nat] List<a>
def Take =
	[type a]
	[xs, n]
	Nat.RepeatLazy(n).begin.case {
		.end! => .end xs.end,
		.step i =>
			do { xs.item[x] } in
			.item(x)
			i.next.loop,
	}
